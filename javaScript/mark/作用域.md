作用域概述

作用域简单来说就是变量起作用的范围和区域。作用域的目的就是隔离变量，保证不同作用域下同名变量不会冲突。



### JS中的作用域

js中主要有三种作用域类型，**全局作用域**，**局部(函数)作用域**，es6后新增了**块级作用域**。

##### 全局作用域

全局作用域主要有以下几种

1. 最外层定义的函数和变量可以在任意地方被访问
2. 未经声明直接
3. window上挂载的属性都具有全局作用域

```
// 全局作用域
// 1. 最外层定义的函数和变量可以在任意地方被访问
var test;

function scope() {

}
//2. 未经声明直接
console.log(a)

// 3. window上挂载的属性
window.test3 = 'test3'
```

##### 局部(函数)作用域

局部作用域就是指在函数内部创建的变量，外部无法访问。这些变量的作用域仅限于函数内部。每个局部作用域之间相互独立。

> **注意：** 块语句(就是{}内的语句)，比如if，for,while等不会创建新的作用域。

```
//局部作用域
function func() {
    var a = 0 // a的作用域就仅为函数内部，外部无法访问到
}

if(true){
  var b = 10 // 这个还是全局作用域，外部可以访问到b
}

for (var i = 0; i < 1; i++) {
    var c = i 
    console.log(`内部打印`, i, c) // 0,0
}
console.log(`外部打印`, i, c)//1,0
```

##### 块级作用域

声明了let和const 的代码块{},就会变成一个块级作用域。作用域内声明的变量只能在作用域内访问。

```
function test(){
	let j = 0;
}

for (let i = 0; i < 1; i++) {
    let j = 0;
    console.log(i, j) //0 ,0
}
console.log(i, j)// i is not defind 说明i的作用域在for的代码块中
```



### 作用域链

作用域链就是查找变量时，先在本层作用域链中寻找声明位置，如果没有找到则去上一层查找，由内到外层层查找，直到找到为止。如果没找到就抛错。



### 补充

在js编译原理中声明一个变量分为了两个阶段

```
var test = 'test'
```

1. 编译阶段，编译器在当前作用域中声明一个test
2. 执行阶段，js引擎在当前作用域中查抄到这个变量，并赋值



**输出变量**值时候查找方式**RHS**，**找到变量**为其赋值查找方式是**LHS**。LHS（Left-hand Side）、RHS（Right-hand Side）是JS引擎执行代码的时候，**查询变量的两种方式**。这里的“Left”和“Right”，是相对于赋值操作来说，当变量出现在赋值操作左侧时，执行LHS操作。

```js
var name = '小明'
复制代码
```

LHS 意味着 **变量赋值**或**写入内存**，,他强调是**写入**这个动作，所以LHS查询的是这个变量对应的**内存地址**。

当变量出现在赋值操作右侧或没有赋值操作时，是RHS。

```js
var Myname = name
console.log(name)
复制代码
```

RHS意味着 **变量查找**或**读取内存**，它强调的是**读**这个**动作**，查询的是变量的**内容**。

